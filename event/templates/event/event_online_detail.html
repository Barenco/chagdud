{% extends 'khadro_ling/base.html' %}
{% load static %}


{% block head %}
<title>Evento | Khadro Ling</title>
{% endblock %}

{% block body %}
<div class="container tituloEvento">
  <div class="col-md-6">
    <div class="row">
    <div class="data col-md-1 mb-2">
      <p class="diaData">{{ event.start_date.day }}</p>
      <p class="mesData">{{ event.short_month }}</p>
    </div>
    <div class="col-md-9">
      <h1 class="mb-3 titulo text-dark">{{ event.name }}</h1>
    </div>
  </div>
  </div>
</div>
<div class="bannerSobre" style="background-color:#333">
  <div class="container">
    <div class="row">
      <div class="col-md-5 col-sm-12 text-white mt-5 pt-1">
        <p><i class="fa fa-user" aria-hidden="true"></i> | Com {{ event.vajra_master }}</p>
        <p><i class="fa fa-calendar" aria-hidden="true"></i> | De {{ event.start_date_pretty }}, a {{ event.end_date_pretty }}</p>
        <p><i class="fa fa-check-square-o" aria-hidden="true"></i>
          {% if event.requirements %}
            | {{ event.requirements }}
          {% else %}
            | Não há pré-requisitos para a participação neste evento.
          {% endif %}
        </p>
        <p><i class="fa fa-map-marker" aria-hidden="true"></i> | {{ event.event_type.capitalize }}</p>
      </div>
      <div class="col-md-7 col-sm-12 pt-1">
        <img class="imgEvento" src="{% static 'khadro_ling/images/khadro.jpg' %}" width="100%">

      </div>
      </div>
    </div>
  </div>
</div>

<main>
  <div class="sobre">
    <div class="container">
      <div id="evento" >
        <div class="row align-items-center">   
          <div class="mb-5 col-md-7 offset-md-1 offset-md-0 col-sm-12 text-justify border-right pr-5">
            <p>
              {{ event.description | linebreaks }}
            </p>
          </div>

          <div class="col-md-4 col-sm-12 mb-5 pl-5">
            <h3 class="titulo mb-3"> Utilidades</h3>
            <p><i class="fa fa-bed" aria-hidden="true"></i> | Tipos de hospedagem</p>
            <p><i class="fa fa-map" aria-hidden="true"></i> | Como chegar</p>
            <p><i class="fa fa-bus" aria-hidden="true"></i> | Translados</p>
            <p><i class="fa fa-cutlery" aria-hidden="true"></i> | Alimentação</p>
            <p><i class="fa fa-info" aria-hidden="true"></i> | Outras informações</p>
            <p><i class="fa fa-envelope" aria-hidden="true"></i> | Contato</p>
            <p><i class="fa fa-times" aria-hidden="true"></i> | Cancelamento</p>
          </div>
        </div>

        <div class="col-12 d-flex justify-content-center align-items-center py-5">
          <b></b>
          <h3 class="text-center titulo mr-5 ml-5"> Ficha de Inscrição </h3>
          <b></b>
        </div>

      <div class="row mt-4">
        <div class="col-md-10 offset-md-1 offset-md-0 col-sm-12">

            <h4 class="titulo">Dados Pessoais </h4>
            <b></b>

          <div class="row mt-5">
            <div class="col-md">
              <form action="{% url 'event:online-event-form' %}" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="form-group">
                  <label for="nome">Nome Completo</label>
                  {{ form.name }}
                  <small id="passwordHelpBlock" class="form-text text-muted">
                    Sem abreviações           
                  </small>
                </div>
              </div>
              <div class="col-md">
                <div class="form-group">
                  <label for="email">Email</label>
                  {{ form.email }}
                </div>
              </div>
              </div>
              <div class="row">
                <div class="col-md">
                <div class="form-group">
                  <label for="telefone">Telefone / Celular</label>
                  {{ form.phone }}
                </div>
              </div>
              <div class="col-md">
                <div class="form-group">
                  <label for="dataNascimento">Data de Nascimento</label>
                  {{ form.birth_date }}
                </div>
              </div>
              </div>
              <div class="row">
                <div class="col-md">
                <div class="form-group">
                  <label for="endereco">Endereço</label>
                  {{ form.address }}
                </div>
              </div>
              <div class="col-md">
                <div class="form-group">
                  <label for="cidade">Cidade</label>
                  {{ form.city }}
                </div>
              </div>
              </div>
              <div class="row">
                <div class="col-md">
                <div class="form-group">
                  <label for="Estado">Estado</label>
                  {{ form.state }}
                </div>
              </div>
              <div class="col-md">
                <div class="form-group">
                  <label for="CEP">CEP</label>
                  {{ form.cep }}
                </div>
              </div>
            </div>

            <div class="policies-title">
              <h4 class="titulo">Ao enviar essa ficha de inscrição:</h4>
              <b></b>
            </div>
          
            {{ event.policies | safe }}
        
            <div class="form-check mt-5">
              {{ form.accepts_policy_terms}}
              <label class="form-check-label" for="aceitoPolitica">
                Li e aceito os termos acima.
              </label>
            </div>

            <div class="payment-title">
              <h4 class="titulo">Formas de pagamento</h4>
              <b></b>
            </div>

            {% if user_language == 'pt-br' %}
              <div class="payment-container">
                {% for payment in form.payment_options %}
                  <div class="form-check mt-2">
                    {{ payment }}
                  </label>
                </div>
                {% endfor %}

                <div id="deposit-container" class="hidden">
                  <h6 class="mt-5"><strong>Dados para depósito</strong></h6>
                  <hr>
                  <p>
                    Banco do Brasil<br>
                    Titular: Chagdud Gonpa Brasil<br>
                    CNPJ: 00.990.708/0001-37<br>
                    Agência: 1380-3<br>
                    Conta: 5454-2<br>
                    Chave PIX: eventos@templobudista.org<br>
                  </p>
                  
                  <div class="form-group">
                    <label for="data">Valor do Depósito</label>
                    {{ form.deposit_value }}
                  </div>

                  <div class="form-group">
                    <label for="data">Data do Depósito</label>
                    {{ form.deposit_date }}
                  </div>

                  <div class="form-group mt-5">
                    <label for="comprovante">Envie o comprovante</label>
                    {{ form.deposit_receipt }}
                  </div>
                </div>

                <div id="credit-container" class="hidden">
                  <small>Você será redirecionado para uma outra página.</small>
                </div>

                <button id="submit-btn" type="submit" class="btn btn-primary mt-5 hidden"></button>
              </div>
              
            {% else %}

            {% endif %}


          </form>
        </div>
      </div>
    </div>
  </div>
</main>

<script>
  const depositCheck = document.getElementById("id_payment_options_0")
  const depositContainer = document.getElementById("deposit-container")

  const creditCheck = document.getElementById("id_payment_options_1")
  const creditContainer = document.getElementById("credit-container")

  const button = document.getElementById("submit-btn")

  creditCheck.onclick = function(){
    button.style.display = 'block';
    button.innerText = 'Realizar pagamento';

    creditContainer.style.display = 'block';
    depositContainer.style.display = 'none';
    
    window.open(url,'_blank');
  };

  depositCheck.onclick = function(){
    button.style.display = 'block';
    button.innerText = 'Enviar';

    creditContainer.style.display = 'none';
    depositContainer.style.display = 'block';
  };

  button.onclick = function(){
    const form = document.getElementsByTagName("form")[0]
    const isValidForm = form.checkValidity();
    if (isValidForm){
      window.open('{{ event.cielo_link }}','_blank');
    }
  };

</script>

{% endblock %}
